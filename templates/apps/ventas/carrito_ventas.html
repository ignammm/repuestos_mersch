{% extends 'layouts/base.html' %}

{% block content %}

<!-- Formulario para agregar productos al carrito -->
<form action="{% url 'ventas:agregar_producto' %}" method="post" class="mt-3">
    {% csrf_token %}
    <div class="mb-3">
        <label for="codigo_barra" class="form-label">CÃ³digo de Barras</label>
        <input type="text" id="codigo_barra" name="codigo_barra" class="form-control" autofocus required>
    </div>
    <div class="mb-3">
        <label for="cantidad" class="form-label">Cantidad</label>
        <input type="number" id="cantidad" name="cantidad" class="form-control" value="1" min="1" required>
    </div>
    <button type="submit" class="btn btn-primary">Agregar al Carrito</button>
</form>


<hr>


<h1>Carrito</h1>

<!-- Tabla del carrito -->
{% if carrito %}
    <table class="table">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Cantidad</th>
                <th>Precio</th>
                <th>Total</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in carrito %}
            <tr>
                <td>{{ item.nombre }}</td>
                <td>{{ item.cantidad }}</td>
                <td>${{ item.precio }}</td>
                <td>${{ item.articulo_total }}</td>
                <td>
                    <a href="{% url 'ventas:eliminar_producto' item.codigo %}" class="btn btn-danger btn-sm">Eliminar</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <p><strong>Total:</strong> ${{ total|floatformat:2 }}</p>

    <form action="{% url 'ventas:finalizar_venta' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-success">Finalizar Venta</button>
    </form>

{% else %}
    <p>No hay productos en el carrito.</p>
{% endif %}

{% endblock %}
